# 決済機能の実装

## stripeのアカウント作成

パブリックキーとシークレットキーを取得し、`.env`に記載する。

```diff:.env
・
・
・
+ STRIPE_PUBLIC_KEY=pk_test_51HtsyfBLbIROWoxVn3hhkfSOFKaoKMO9L9L8b7Zfi8lV7qxI8Wj600ViDB6O9M4li62YJPZBDi9wC3E3A5yHtnF40047xwOUgR
+ STRIPE_SECRET_KEY=sk_test_51HtsyfBLbIROWoxVlVNm0MVcEkIynOkhnA1RBQ52tvUDa5rS6cG1mTIUoMu71Niy0WPlaProqg3HTRasHRwnFcXd00TktWJIES
```

## stripe/stripe-phpのインストール

```console
$ composer require stripe/stripe-php
```

## 決済画面の実装


```diff:カート画面？？
<script src="https://js.stripe.com/v3/"></script>

<script>
    const publicKey = '{{ $publicKey }}';

    var stripe = Stripe(publicKey);

    // 決済ボタンが押下されたら決済画面にリダイレクトする
    function onClick() {
        stripe.redirectToCheckout({
            sessionId: '{{ $session->id }}'
        }).then(function (result) {
          console.log(result)
            // If `redirectToCheckout` fails due to a browser or network
            // error, display the localized error message to your customer
            // using `result.error.message`.
        });
    }
</script>

<h1>決済フォーム(Checkout)</h1>

<button onclick="onClick()">決済画面へ</button>
```
